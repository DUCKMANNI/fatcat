<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{shopping/layout}">
<head>
<title>쇼핑몰 목록 페이지</title>
</head>
<body>


	<div layout:fragment="shopContent"
		class="container-fluid my-3 d-flex flex-column align-items-center">

		<!-- 🔍 검색창 -->
		<div class="d-flex justify-content-end w-100 mb-3 pe-5 me-5">
		    <form th:action="@{/products}" method="get"
		          class="row align-items-center g-2"  style="max-width: 800px;">
		
		        <div class="col-9">
		            <input type="text" name="keyword" class="form-control"
		                   placeholder="상품명을 입력하세요"
		                   th:value="${param.keyword}">
		        </div>
		
		        <div class="col-3">
		            <button type="submit" class="btn btn-fatcat w-100">검색</button>
		        </div>
		
		    </form>
		</div>



		<!-- 상품목록 시작 -->
		<div class="product-grid">
			<div class="product-card me-5" th:each="product : ${products}">
				<a th:href="@{/products/detail(productCode=${product.productCode})}"
					class="text-decoration-none text-dark"> <img
					th:src="${product.productImageList.^[imageTypeCode == 'm']?.fileName}"
					th:alt="${product.productName}" class="border rounded"> <span
					th:text="${product.productName}"></span>
				</a>
				<p
					th:text="'가격 : ' + ${#numbers.formatInteger(product.productPrice, 3, 'COMMA')} + '원'"></p>
			</div>
		</div>
		<!-- 상품목록 종료 -->

		<!-- 페이지네이션 (초간단) -->
		<nav th:if="${productPage.totalPages > 1}" class="mt-4">
			<ul class="pagination justify-content-center">

				<!-- 이전 -->
				<li class="page-item"
					th:classappend="${productPage.first} ? 'disabled'"><a
					class="page-link"
					th:href="@{/products(page=${productPage.number - 1}, size=${productPage.size},
                              category=${#strings.isEmpty(main)?'all':main},
                              sub=${#strings.isEmpty(sub)?null:sub},
                              detail=${#strings.isEmpty(detail)?null:detail})}">
						이전 </a></li>

				<!-- 번호 -->
				<li class="page-item"
					th:each="i : ${#numbers.sequence(0, productPage.totalPages - 1)}"
					th:classappend="${i == productPage.number} ? 'active'"><a
					class="page-link" th:text="${i + 1}"
					th:href="@{/products(page=${i}, size=${productPage.size},
                              category=${#strings.isEmpty(main)?'all':main},
                              sub=${#strings.isEmpty(sub)?null:sub},
                              detail=${#strings.isEmpty(detail)?null:detail})}">
				</a></li>

				<!-- 다음 -->
				<li class="page-item"
					th:classappend="${productPage.last} ? 'disabled'"><a
					class="page-link"
					th:href="@{/products(page=${productPage.number + 1}, size=${productPage.size},
                              category=${#strings.isEmpty(main)?'all':main},
                              sub=${#strings.isEmpty(sub)?null:sub},
                              detail=${#strings.isEmpty(detail)?null:detail})}">
						다음 </a></li>

			</ul>
		</nav>

	</div>
</body>
</html>
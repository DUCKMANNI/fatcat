<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{shared/layout}">

   
<body>
        <div layout:fragment="content">

	<!-- 질문 -->
	<h2 class="border-bottom py-2" th:text="${post.postTitle}"></h2>

	<!-- 내용 -->
	<div class="card my-3">
		<div class="card-body">
			<div class="card-text">
				<div th:text="${post.postContent}"></div>
			</div>
		</div>



		<div class="d-flex justify-content-end">
			<div class="badge bg-light text-dark p-2 text-start">

				<!-- 수정 버튼 
				<div class="my-2">
					<a th:href="@{|/question/modify/${question.id}|}"
						class="btn btn-sm btn-outline-secondary"
						sec:authorize="isAuthenticated()"
						th:if="${question.author != null and
                        #authentication.getPrincipal().getUsername() 
                        == question.author.username}"
						th:text="수정"></a>
				</div>
                 -->

				<!-- 작성자 이름 나타내기 -->
				<div class="mb-2">
					<span th:if="${post.user != null}"
						th:text="${post.user.username}"></span>
				</div>

				<!-- 작성시간 나타내기 -->
				<div
					th:text="${#temporals.format(post.createDate, 'yyyy-MM-dd HH:mm')}"></div>

			</div>
		</div>





		<div class="my-2">

			<!-- 수정 버튼 -->
			<a th:href="@{|/post/modify/${post.postSeq}|}"
				class="btn btn-sm btn-warning" sec:authorize="isAuthenticated()"
				th:if="${post.user != null and
                        #authentication.getPrincipal().getUsername() 
                        == post.user.username}"
				th:text="수정"></a>


			<!-- 삭제 버튼 -->
			<a href="javascript:void(0)"
				th:data-uri="@{|/post/delete/${post.postSeq}|}"
				class="delete btn btn-sm btn-primary"
				sec:authorize="isAuthenticated()"
				th:if="${post.user != null and
                        #authentication.getPrincipal().getUsername() 
                        == post.user.username}"
				th:text="삭제"></a>

		</div>





	</div>



	<!-- 답변 갯수-->
	<h5 class="border-bottom my-3 py-3"
		th:text="|${#lists.size(post.knowledgeCommentList)}개의 답변이 있습니다!!|"></h5>



	<!-- 답변 목록 -->
	<div class="card my-3" th:each=" comment : ${post.knowledgeCommentList}">
		<div class="card-body">
			<div class="card-text" style="white-space: pre-line;"
				th:text="${comment.commentContent}"></div>
		</div>



		<!-- 답변 날짜! -->
		<div class="d-flex justify-content-end">
			<div class="badge bg-light text-dark p-2 text-start">

				<div class="mb-2">
					<span th:if="${comment.user != null}"
						th:text="${comment.user.username}"></span>
				</div>
				<div
					th:text="${#temporals.format(comment.createDate, 'yyyy-MM-dd HH:mm')}"></div>
			</div>
		</div>



		<div class="my-2">

			<!-- 수정 버튼 -->
			<a th:href="@{|/comment/modify/${comment.commentSeq}|}"
				class="btn btn-sm btn-warning" sec:authorize="isAuthenticated()"
				th:if="${comment.user != null and
                        #authentication.getPrincipal().getUsername() 
                        == comment.user.username}"
				th:text="수정"></a>


			<!-- 삭제 버튼 -->
			<a href="javascript:void(0)"
				th:data-uri="@{|/comment/delete/${comment.commentSeq}|}"
				class="delete btn btn-sm btn-primary"
				sec:authorize="isAuthenticated()"
				th:if="${comment.user != null and
                        #authentication.getPrincipal().getUsername() 
                        == comment.user.username}"
				th:text="삭제"></a>

		</div>




	</div>


	<!-- 답변 등록 -->
	<form th:action="@{|/comment/create/${post.postSeq}|}"
		th:object="${commentForm}" method="post">

		<div th:replace="~{form_errors :: formErrorsFragment }"></div>

		
		<textarea sec:authorize="isAuthenticated()" class="form-control"
			rows="10" th:field=*{content}></textarea>
		<input class="btn btn-warning my-3" type="submit" value="답변 등록하기">
	</form>


<!-- delete -->
<script type='text/javascript' layout:fragment="script">

const delete_elements = document.getElementsByClassName("delete");
Array.from(delete_elements).forEach(function(element){
	
	element.addEventListener('click', function(){
		
		if(confirm("정말 삭제하시겠습니까??")){
			location.href = this.dataset.uri;
		}
	});
	
});

</script>
</div>
</body>
</html>
